## Functional Response Functions 
# Each function specification needs to be listed in 'resp_known' with a description.
## resp_known is the master list of usable functions.
## each named entry here must have a corresponding function entry (e.g. fr_rogersII.R) and vice versa!
fr_responses <- function(show=FALSE){
    resp_known <- list("typeI"="A generic linear type I response", 
                       "rogersII"="Roger's type II decreasing prey function")
    if(show){
        C1 <- c('Response',names(resp_known))
        C2 <- 'Parameters'
        C3 <- c('Description',as.character(unlist(resp_known)))
        for (a in 1:length(resp_known)) { 
            C2 <- c(C2, paste(names(formals(fun=get(names(resp_known)[a]))), collapse=','))
        }
        C1n <- max(sapply(C1,nchar))+4
        C2n <- max(sapply(C2,nchar))+4
        C3n <- max(sapply(C2,nchar))+4
        # Print
        cat(format(C1[1], width=C1n),format(C2[1], width=C2n), format(C3[1], width=C3n), '\n', sep='')
        cat(format(paste(rep('-',C1n-4), collapse=''), width=C1n),format(paste(rep('-',C2n-4), collapse=''), width=C2n), format(paste(rep('-',C3n-4), collapse=''), width=C3n), '\n', sep='')
        for(a in 2:length(C1)){
            cat(format(C1[a], width=C1n),format(C2[a], width=C2n), format(C3[a], width=C3n), '\n', sep='')
        }
        cat('\n')
    } else {
        return(resp_known)
    }
}

# fr_setupout
# Utility function to help clean up the code in the various statitic functions
# NB: This setups a single vector, as used by the various dual-duty functional response functions (e.g. rogersII_fit) NOT the output of friar_fit
# Returns a vector of (correctly) named NA's, based on the start and fixed input to the statitic function
fr_setupout <- function(start, fixed, samp){
    out <- c(rep(NA, times=length(names(start))*2), rep(NA, times=length(names(fixed))), samp)
    outnames <- NULL
    # Setup optimised variable output
    for (i in 1:length(names(start))){
        outnames <- c(outnames, names(start)[i], paste(names(start)[i], 'var', sep=''))
    }
    # Setup fixed variable output
    for (i in 1:length(names(fixed))){
        outnames <- c(outnames, names(fixed)[i])
    }
    names(out) <- c(outnames, rep('', times=length(samp)))
    return(out)
}